# 🔧 Panduan Debugging Dashboard Absensi

## 🚀 Method 1: Debug Langsung di Browser (RECOMMENDED)

### Step 1: Jalankan Server Symfony
```bash
cd C:\xampp\htdocs\gembira
symfony server:start
# Atau: php -S localhost:8000 -t public
```

### Step 2: Akses Dashboard
1. Buka browser: `http://localhost:8000/`
2. Login sebagai pegawai
3. **Lihat debug output** di halaman web

### Step 3: Analisis Output Debug
Akan muncul 4 box debug di halaman:

```
📅 SIMPLE DEBUG: Hari ini
- hari_number: 1
- hari_nama: "Senin"
- datetime: "2025-01-15 14:30:00"

🗄️ SIMPLE DEBUG: Database
- total_jadwal_db: 7
- jadwal_hari_ini: 0  ← MASALAH DI SINI!
- problem: "❌ TIDAK ADA JADWAL HARI INI"

🎯 SIMPLE DEBUG: Final Result
- kartu_dibuat: 0
- status: "❌ MASALAH: Kartu kosong"

🚨 ROOT CAUSE ANALYSIS:
- database_kosong: "NO"
- tidak_ada_hari_ini: "YES"  ← ROOT CAUSE!
- action_needed: "Periksa database table jadwal_absensi"
```

## 🧪 Method 2: Unit Test Debug

### Jalankan Unit Test:
```bash
cd C:\xampp\htdocs\gembira
php bin/phpunit tests/Debug/DashboardSimpleTest.php
```

### Expected Output:
```
=== 🔍 DEBUG: Database Jadwal Absensi ===
📋 Total jadwal di database: 7
- ID:1 | Apel Pagi | Hari:[1,2,3,4,5] | Jam:07:00-07:30 | Aktif:YES
- ID:2 | Upacara | Hari:[1] | Jam:NULL-NULL | Aktif:YES

📅 Hari ini: 1 (Senin)
🎯 Jadwal untuk hari ini: 0
❌ PROBLEM: Tidak ada jadwal untuk hari 1!
💡 SOLUSI: Periksa kolom hari_diizinkan di database
```

## 📊 Method 3: Database Direct Check

### Query Manual:
```sql
-- 1. Cek semua jadwal
SELECT id, jenis_absensi, hari_diizinkan, jam_mulai, jam_selesai, is_aktif 
FROM jadwal_absensi;

-- 2. Cek jadwal untuk hari ini (Senin = 1)
SELECT * FROM jadwal_absensi 
WHERE is_aktif = 1 
AND JSON_CONTAINS(hari_diizinkan, '1') = 1;

-- 3. Cek format hari_diizinkan
SELECT id, hari_diizinkan, 
       JSON_VALID(hari_diizinkan) as valid_json,
       JSON_CONTAINS(hari_diizinkan, '1') as contains_monday
FROM jadwal_absensi;
```

## 🔍 Common Problems & Solutions

### Problem A: `jadwal_hari_ini: 0` (No schedules found)
**Cause:** Array `hari_diizinkan` format salah
**Solution:** 
```sql
UPDATE jadwal_absensi 
SET hari_diizinkan = '[1,2,3,4,5]'  -- Senin-Jumat
WHERE hari_diizinkan IS NULL OR hari_diizinkan = '';
```

### Problem B: `jam_mulai: NULL` atau `jam_selesai: NULL`
**Cause:** Time fields kosong
**Solution:**
```sql
UPDATE jadwal_absensi 
SET jam_mulai = '07:00:00', jam_selesai = '07:30:00'
WHERE jam_mulai IS NULL OR jam_selesai IS NULL;
```

### Problem C: `is_aktif: NO`
**Cause:** Jadwal tidak aktif
**Solution:**
```sql
UPDATE jadwal_absensi SET is_aktif = 1 WHERE id = [ID_JADWAL];
```

## 🧹 Cleanup Debug Code

Setelah masalah teridentifikasi dan diperbaiki:

1. **Hapus debug dump** dari `DashboardController.php`:
   - Hapus semua `dump("🚀 SIMPLE DEBUG: ...")` 
   - Hapus `dump("🗄️ SIMPLE DEBUG: ...")`
   - Hapus `dump("🎯 SIMPLE DEBUG: ...")`
   - Hapus `dump("🚨 ROOT CAUSE ANALYSIS:")`

2. **Hapus file debug:**
   ```bash
   rm tests/Debug/DashboardSimpleTest.php
   rm DEBUGGING_INSTRUCTIONS.md
   ```

## 🆘 Emergency Quick Fix

Jika butuh fix cepat tanpa debugging:

```sql
-- Pastikan ada minimal 1 jadwal aktif untuk hari ini
INSERT INTO jadwal_absensi (
    jenis_absensi, nama_jenis_absensi, hari_diizinkan, 
    jam_mulai, jam_selesai, is_aktif
) VALUES (
    'apel_pagi', 'Apel Pagi', '[1,2,3,4,5]',
    '07:00:00', '07:30:00', 1
);
```

---
**Generated by Claude Code Debugging System**